<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Participantes do Bol√£o</title>
<style>
    body {
        box-sizing: border-box;
    }
    * { box-sizing: border-box; font-family: "Poppins", sans-serif; }
    body { 
        margin: 0; 
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        min-height: 100%; 
        color: #fff;
        padding: 20px;
    }
    html {
        height: 100%;
    }
    .popup { 
        background: #ffffff;
        backdrop-filter: blur(15px);
        width: 95%; 
        max-width: 480px; 
        border-radius: 25px; 
        padding: 30px 25px; 
        box-shadow: 0 20px 40px rgba(0,0,0,0.4), 0 0 0 2px rgba(255,255,255,0.1); 
        text-align: center; 
        animation: aparecer 0.6s ease;
        border: 2px solid rgba(255, 255, 255, 0.2);
    }
    @keyframes aparecer { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    h1 { 
        font-size: 28px; 
        color: #333;
        text-shadow: 2px 2px 6px rgba(0,0,0,0.1);
        margin-bottom: 8px; 
        text-transform: uppercase; 
        letter-spacing: 1.5px; 
        font-weight: 700;
    }
    h2 { font-size: 15px; font-weight: normal; color: #333; margin-bottom: 20px; line-height: 1.5; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
    h3 { font-size: 15px; font-weight: normal; color: #333; margin-bottom: 20px; line-height: 1.5; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
    input { 
        width: 90%; 
        padding: 14px 16px; 
        margin: 8px 0; 
        border: 2px solid #000; 
        border-radius: 15px; 
        font-size: 15px; 
        text-align: center; 
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(5px);
        color: #333;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    input:focus { 
        border-color: #000; 
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); 
        outline: none; 
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 1);
    }
    button { 
        width: 92%; 
        padding: 16px; 
        margin-top: 12px; 
        border: none; 
        border-radius: 15px; 
        background: linear-gradient(135deg, #ffd700, #ffb347); 
        color: #333; 
        font-size: 16px; 
        font-weight: 700; 
        cursor: pointer; 
        transition: all 0.3s ease;
        box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    button:hover { 
        transform: translateY(-3px) scale(1.02); 
        box-shadow: 0 12px 25px rgba(255, 215, 0, 0.6);
        background: linear-gradient(135deg, #ffed4e, #ffc947); 
    }
    .mensagem { margin-top: 15px; font-size: 15px; font-weight: 600; transition: all 0.3s; padding: 10px; border-radius: 10px; }

    /* === MODAL === */
    .overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(8px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }
    .modal {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        width: 90%;
        max-width: 480px;
        padding: 25px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.4), 0 0 0 2px rgba(255,255,255,0.1);
        animation: aparecer 0.4s ease;
        text-align: center;
        border: 2px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }
    .modal h3 {
        margin-top: 0;
        font-size: 22px;
        color: #ffd700;
        text-shadow: 2px 2px 6px rgba(0,0,0,0.8);
        margin-bottom: 15px;
        font-weight: 600;
    }
    .close-btn {
        background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 15px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    }
    .close-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
    }
    .search-box { position: relative; width: 100%; margin-bottom: 15px; }
    .search-box input { 
        width: 100%; 
        padding: 12px 40px 12px 15px; 
        font-size: 14px; 
        border-radius: 12px; 
        border: 2px solid rgba(102, 126, 234, 0.2);
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(5px);
    }
    .search-box svg { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #667eea; }
    .lista { 
        text-align: left; 
        font-size: 13px; 
        max-height: 280px; 
        overflow-y: auto; 
        color: #fff; 
        padding: 0 8px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .lista div { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        padding: 6px 8px; 
        border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
        white-space: nowrap;
        transition: all 0.2s ease;
        cursor: pointer;
    }
    .lista div:hover {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        transform: translateX(2px);
    }
    
    /* Sele√ß√£o m√∫ltipla */
    .checkbox-container {
        display: flex;
        align-items: center;
        margin-right: 10px;
    }
    
    .checkbox-container input[type="checkbox"] {
        width: 18px;
        height: 18px;
        margin: 0;
        cursor: pointer;
        accent-color: #ffd700;
    }
    
    .lista div.selected {
        background: rgba(255, 215, 0, 0.2) !important;
        border: 2px solid rgba(255, 215, 0, 0.5) !important;
        border-radius: 8px !important;
    }
    
    .selection-actions {
        display: none;
        gap: 8px;
        margin-bottom: 15px;
        justify-content: center;
        padding: 10px;
        background: rgba(255, 215, 0, 0.1);
        border-radius: 10px;
        border: 1px solid rgba(255, 215, 0, 0.3);
    }
    
    .selection-actions button {
        flex: 1;
        padding: 10px 8px;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.2s ease;
    }
    
    .selection-actions .status-btn {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        box-shadow: 0 2px 6px rgba(52, 152, 219, 0.3);
    }
    
    .selection-actions .delete-btn {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        color: white;
        box-shadow: 0 2px 6px rgba(231, 76, 60, 0.3);
    }
    
    .selection-counter {
        color: #ffd700;
        font-weight: bold;
        text-align: center;
        margin-bottom: 10px;
        font-size: 13px;
    }
    .status { font-weight: bold; text-transform: uppercase; font-size: 11px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
    .pago { color: #00ff88; }
    .nao-pago { color: #ff6b6b; }
    .status-btn {
        padding: 4px 10px;
        border-radius: 8px;
        border: none;
        font-size: 10px;
        font-weight: bold;
        cursor: pointer;
        margin-left: 8px;
        transition: all 0.2s ease;
    }
    .status-btn.pago { 
        background: linear-gradient(135deg, #00b894, #00cec9); 
        color: white; 
        box-shadow: 0 2px 8px rgba(0, 184, 148, 0.3);
    }
    .status-btn.nao-pago { 
        background: linear-gradient(135deg, #e17055, #fdcb6e); 
        color: white; 
        box-shadow: 0 2px 8px rgba(225, 112, 85, 0.3);
    }
    .status-btn:hover {
        transform: translateY(-1px);
    }

    /* Filtros */
    .filter-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .filter-btn.active {
        background: linear-gradient(135deg, #667eea, #764ba2) !important;
        color: white !important;
        box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3) !important;
        border: none !important;
    }

    /* Progresso */
    .progress-container {
        margin: 20px 0;
        padding: 15px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        backdrop-filter: blur(5px);
        border: 2px solid rgba(255, 255, 255, 0.2);
    }
    .progress-bar {
        width: 100%;
        height: 16px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #ffd700, #ffb347, #ff6b6b);
        width: 0%;
        transition: width 0.8s ease;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(255, 215, 0, 0.6);
        position: relative;
    }
    .progress-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        animation: shimmer 2s infinite;
    }
    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    .progress-text {
        font-size: 13px;
        margin-top: 8px;
        color: #333;
        font-weight: 600;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }

    /* Popup Informativo */
    .info-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        animation: fadeIn 0.5s ease;
    }
    
    .info-modal {
        background: #ffffff;
        border: none;
        border-radius: 5px;
        width: 90%;
        max-width: 500px;
        max-height: 80vh;
        padding: 25px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3), 0 0 0 1px rgba(0,0,0,0.1);
        animation: slideIn 0.6s ease;
        position: relative;
        overflow-y: auto;
        transform: rotate(-1deg);
    }
    
    .info-modal::before {
        content: '';
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 40px;
        height: 20px;
        background: rgba(255, 193, 7, 0.8);
        border-radius: 2px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .info-content {
        font-family: 'Arial', sans-serif;
        color: #333;
        line-height: 1.6;
        font-size: 14px;
        padding: 0;
    }
    
    .info-title {
        text-align: center;
        font-size: 18px;
        font-weight: bold;
        color: #d32f2f;
        margin-bottom: 20px;
        text-transform: uppercase;
        letter-spacing: 1px;
        border-bottom: 2px solid #d32f2f;
        padding-bottom: 10px;
    }
    
    .info-section {
        margin-bottom: 15px;
    }
    
    .info-section h4 {
        color: #1976d2;
        font-weight: bold;
        margin: 10px 0 5px 0;
        font-size: 15px;
    }
    
    .info-highlight {
        background: rgba(255, 87, 34, 0.2);
        padding: 2px 4px;
        border-radius: 3px;
        font-weight: bold;
        color: #d84315;
    }
    
    .info-close-btn {
        background: linear-gradient(135deg, #4caf50, #66bb6a);
        border: none;
        color: #fff;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        margin: 20px auto 0;
        display: block;
        font-size: 16px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    }
    
    .info-close-btn:hover {
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 16px rgba(76, 175, 80, 0.6);
        background: linear-gradient(135deg, #66bb6a, #81c784);
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes slideIn {
        from { opacity: 0; transform: scale(0.8) translateY(-50px); }
        to { opacity: 1; transform: scale(1) translateY(0); }
    }

    /* Teclado Virtual */
    .virtual-keyboard {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        border-radius: 15px;
        padding: 15px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.8), 0 0 0 2px rgba(255,255,255,0.1);
        z-index: 3000;
        display: none;
        border: 2px solid rgba(255, 215, 0, 0.3);
        backdrop-filter: blur(15px);
        animation: popIn 0.3s ease;
        width: 220px;
        height: 280px;
        box-sizing: border-box;
    }
    
    @keyframes popIn {
        from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
        to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
    
    .keyboard-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        width: 100%;
    }
    
    .key-btn {
        width: 55px;
        height: 40px;
        background: linear-gradient(135deg, #ffd700, #ffb347);
        border: none;
        border-radius: 8px;
        color: #333;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 3px 8px rgba(255, 215, 0, 0.4), inset 0 1px 0 rgba(255,255,255,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid rgba(255, 255, 255, 0.2);
        flex: 1;
        margin: 0 2px;
    }
    
    .key-btn:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 5px 12px rgba(255, 215, 0, 0.6), inset 0 1px 0 rgba(255,255,255,0.4);
        background: linear-gradient(135deg, #ffed4e, #ffc947);
    }
    
    .key-btn:active {
        transform: translateY(-1px);
        box-shadow: 0 2px 6px rgba(255, 215, 0, 0.5);
    }
    
    .key-btn.close {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
        box-shadow: 0 3px 8px rgba(231, 76, 60, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
        width: 100%;
        margin: 12px 0 0 0;
        font-size: 13px;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        height: 32px;
        flex: none;
    }
    
    .key-btn.close:hover {
        background: linear-gradient(135deg, #ec7063, #e74c3c);
        box-shadow: 0 5px 12px rgba(231, 76, 60, 0.6), inset 0 1px 0 rgba(255,255,255,0.3);
        transform: translateY(-1px);
    }
    
    .keyboard-header {
        text-align: center;
        color: #ffd700;
        font-size: 13px;
        font-weight: bold;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    
    .password-display {
        background: rgba(0, 0, 0, 0.6);
        border: 2px solid rgba(255, 215, 0, 0.4);
        border-radius: 8px;
        padding: 8px;
        margin-bottom: 12px;
        text-align: center;
        color: #ffd700;
        font-size: 20px;
        font-weight: bold;
        letter-spacing: 10px;
        min-height: 25px;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: inset 0 2px 6px rgba(0,0,0,0.3), 0 2px 8px rgba(255,215,0,0.2);
    }

    @media (max-width: 400px) { 
        h2, h3 { font-size: 14px; } 
        input, button { font-size: 14px; } 
        .lista { font-size: 12px; }
        .popup { padding: 20px 18px; }
        .info-content { font-size: 12px; }
        .info-title { font-size: 16px; }
        
        .virtual-keyboard {
            width: 190px;
            height: 250px;
            padding: 12px;
        }
        
        .key-btn {
            width: 50px;
            height: 35px;
            font-size: 14px;
            margin: 0 1px;
        }
        
        .keyboard-row {
            margin-bottom: 6px;
        }
        
        .password-display {
            font-size: 18px;
            letter-spacing: 8px;
            padding: 6px;
            min-height: 22px;
        }
        
        .key-btn.close {
            height: 28px;
            font-size: 11px;
        }
    }
</style>
</head>
<body>
<div class="popup">
    <h1 id="tituloBolao">üéØ Bol√£o Vai que d√° certo</h1>
    <h3 id="subtituloBolao">üé∞ Mega da Virada 2025! üí∞<br><br>
    ‚úçÔ∏è Preencha os dados corretamente!<br>
    <small>üìã Essas informa√ß√µes ser√£o usadas para entrega das cotas.</small></h3>

    <button id="verRegras" style="background:linear-gradient(135deg,#95a5a6,#bdc3c7);margin:10px 0 5px 0;font-size:11px;padding:6px 12px;width:auto;display:inline-block;opacity:0.7;">üìã Ver Regras</button>

    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">0/80 participantes</div>
    </div>

    <input type="text" id="nome" placeholder="‚úèÔ∏è Nome completo">
    <input type="tel" id="telefone" placeholder="üì± WhatsApp">
    
    <button id="verLista" style="background:linear-gradient(135deg,#6c757d,#adb5bd);margin-top:8px;width:30%;float:left;">Lista</button>
    <button id="cadastrar" style="width:65%;float:right;margin-left:5%;">üöÄ Participar</button>
    <div style="clear:both;"></div>

    <div class="mensagem" id="mensagem"></div>
</div>

<!-- Modal flutuante -->
<div class="overlay" id="overlay">
    <div class="modal">
        <h3>üìã Lista de Participantes</h3>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFillLista"></div>
            </div>
            <div class="progress-text">Progresso de Pagamento</div>
            <div class="progress-text" id="progressTextLista">0/80 cadastrados ‚Ä¢ 0 pagos</div>
        </div>
        
        <div class="search-box">
            <input type="text" id="buscar" placeholder="üîç Buscar participante...">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        </div>
        
        <div class="filter-buttons" style="display: flex; gap: 8px; margin-bottom: 15px; justify-content: center;">
            <button id="filtroTodos" class="filter-btn active" style="flex: 1; padding: 8px 12px; border: none; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: linear-gradient(135deg, #667eea, #764ba2); color: white; box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);">üë• Todos</button>
            <button id="filtroPagos" class="filter-btn" style="flex: 1; padding: 8px 12px; border: none; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: rgba(255, 255, 255, 0.2); color: #fff; border: 1px solid rgba(255, 255, 255, 0.3);">‚úÖ Pagos</button>
            <button id="filtroNaoPagos" class="filter-btn" style="flex: 1; padding: 8px 12px; border: none; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: rgba(255, 255, 255, 0.2); color: #fff; border: 1px solid rgba(255, 255, 255, 0.3);">‚ùå N√£o Pagos</button>
        </div>
        

        
        <div class="selection-counter" id="selectionCounter" style="display: none;"></div>
        <div class="selection-actions" id="selectionActions">
            <button class="status-btn" id="alterarStatusSelecionados">üîÑ Alterar Status</button>
            <button class="notify-btn" id="notificarSelecionados" style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; box-shadow: 0 2px 6px rgba(243, 156, 18, 0.3);">üì± Notificar Selecionados</button>
            <button class="delete-btn" id="excluirSelecionados">üóëÔ∏è Excluir Selecionados</button>
        </div>
        
        <div class="lista" id="lista"></div>
        <button class="close-btn" id="fecharLista">‚ùå Fechar</button>
    </div>
</div>

<!-- Modal de A√ß√µes -->
<div class="overlay" id="acoesOverlay" style="display: none;">
    <div class="modal">
        <h3>‚öôÔ∏è A√ß√µes do Participante</h3>
        <p id="participanteInfo" style="color: #ffd700; font-weight: bold; margin-bottom: 20px;"></p>
        <div style="display: flex; gap: 8px; justify-content: center; margin: 15px 0;">
            <button id="alterarStatus" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; flex: 1; padding: 12px 8px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 13px;">üîÑ Status</button>
            <button id="notificarParticipante" style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; flex: 1; padding: 12px 8px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 13px;">üì± Notificar</button>
            <button id="excluirParticipante" style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; flex: 1; padding: 12px 8px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 13px;">üóëÔ∏è Excluir</button>
        </div>
        <button class="close-btn" id="fecharAcoes">‚ùå Cancelar</button>
    </div>
</div>



<!-- Popup Informativo -->
<div class="info-overlay" id="infoOverlay">
    <div class="info-modal">
        <div class="info-content">
            <div class="info-title">‚ö†Ô∏è INFORMATIVO: BOL√ÉO MEGA DA VIRADA ‚ö†Ô∏è</div>
            
            <div class="info-section">
                Estamos organizando nosso bol√£o, com um total de <span class="info-highlight" id="limiteInfo">80 participantes</span>.<br>
                <strong>Custo por Participante:</strong> <span class="info-highlight" id="valorInfo">R$ 85,00</span>
            </div>
            
            <div class="info-section">
                <h4>Regras de Participa√ß√£o e Prazos:</h4>
                
                <strong>Prioridade:</strong><br>
                Ser√° dada prioridade de participa√ß√£o aos <span class="info-highlight">COLABORADORES da loja</span>.<br>
                Caso as 80 vagas n√£o sejam preenchidas, abriremos a participa√ß√£o para pessoas de fora.
            </div>
            
            <div class="info-section">
                <h4>Datas Limite:</h4>
                <span class="info-highlight" id="dataInteresseInfo">30 de Novembro</span>: Data final para manifestar interesse (confirmar que quer participar).<br>
                <span class="info-highlight" id="dataPagamentoInfo">10 de Dezembro</span>: Data final para o pagamento da cota.
            </div>
            
            <div class="info-section">
                <h4>Aten√ß√£o ao Pagamento:</h4>
                O participante que n√£o realizar o pagamento at√© o dia <span class="info-highlight" id="dataPagamentoInfo2">10 de Dezembro</span> ser√° automaticamente exclu√≠do do bol√£o, e a vaga ser√° repassada.
            </div>
            
            <div class="info-section">
                <h4>Observa√ß√µes Importantes:</h4>
                <strong>Prazos:</strong> As datas foram definidas para que todos tenham tempo suficiente para pagar (contando com o 13¬∫ sal√°rio).<br><br>
                <strong>Agilidade:</strong> Quanto antes arrecadarmos o valor, melhor. Deixar para a √∫ltima hora significa enfrentar lot√©ricas lotadas.<br><br>
                <strong>Jogos:</strong> A quantidade final de bilhetes e jogos ser√° definida ao t√©rmino da arrecada√ß√£o, pois depender√° do valor total arrecadado (se todas as 80 cotas forem preenchidas).
            </div>
        </div>
        
        <button class="info-close-btn" id="fecharInfo">üìã Entendi, vamos come√ßar!</button>
    </div>
</div>

<!-- Teclado Virtual -->
<div class="virtual-keyboard" id="virtualKeyboard">
    <div class="keyboard-header">üîê Digite a Senha</div>
    <div class="password-display" id="passwordDisplay"></div>
    
    <div class="keyboard-row">
        <button class="key-btn" data-key="1">1</button>
        <button class="key-btn" data-key="2">2</button>
        <button class="key-btn" data-key="3">3</button>
    </div>
    
    <div class="keyboard-row">
        <button class="key-btn" data-key="4">4</button>
        <button class="key-btn" data-key="5">5</button>
        <button class="key-btn" data-key="6">6</button>
    </div>
    
    <div class="keyboard-row">
        <button class="key-btn" data-key="7">7</button>
        <button class="key-btn" data-key="8">8</button>
        <button class="key-btn" data-key="9">9</button>
    </div>
    
    <div class="keyboard-row">
        <button class="key-btn" data-key="*">*</button>
        <button class="key-btn" data-key="0">0</button>
        <button class="key-btn" data-key="#">#</button>
    </div>
    
    <button class="key-btn close" data-key="cancel">‚ùå Fechar</button>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, push, get, update, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

// ========================================
// üîß CONFIGURA√á√ïES DO SISTEMA - ALTERE AQUI
// ========================================
const CONFIG = {
  // Configura√ß√µes Gerais
  LIMITE_PARTICIPANTES: 80,
  VALOR_PARTICIPACAO: "R$ 85,00",
  SENHA_ADMIN: "6261",
  
  // Datas Importantes
  DATA_LIMITE_INTERESSE: "30 de Novembro",
  DATA_LIMITE_PAGAMENTO: "10 de Dezembro",
  
  // Informa√ß√µes de Pagamento
  CHAVE_PIX: "(99) 99102-6112",
  
  // Textos do Sistema
  TITULO_BOLAO: "üéØ Bol√£o Vai que d√° certo",
  SUBTITULO: "üé∞ Mega da Virada 2025! üí∞",
  
  // Mensagem de Notifica√ß√£o WhatsApp
  MENSAGEM_NOTIFICACAO: (nome, valor, prazo, chavePix) => {
    // Fun√ß√£o para obter sauda√ß√£o baseada no hor√°rio
    const obterSaudacao = () => {
      const agora = new Date();
      const hora = agora.getHours();
      
      if (hora >= 5 && hora < 12) {
        return "bom dia";
      } else if (hora >= 12 && hora < 18) {
        return "boa tarde";
      } else {
        return "boa noite";
      }
    };
    
    const saudacao = obterSaudacao();
    
    return `*Notifica√ß√£o* üéØ

Ol√°, ${saudacao} ${nome}! 

Estamos aguardando o pagamento da sua participa√ß√£o no *Bol√£o Mega da Virada 2025* no valor de *${valor}*.

üìÖ *Prazo final:* ${prazo}
üí≥ *Chave Pix:* ${chavePix}

Por favor, realize o pagamento at√© o dia 10 para garantir sua vaga no bol√£o.

Obrigado! üçÄ`;
  }
};
// ========================================

const firebaseConfig = {
  apiKey: "AIzaSyCvXGUdvZkqtSMMn8VmTOXLA9PXqR85gSk",
  authDomain: "vagner-34d5b.firebaseapp.com",
  databaseURL: "https://vagner-34d5b.firebaseio.com",
  projectId: "vagner-34d5b",
  storageBucket: "vagner-34d5b.firebasestorage.app",
  messagingSenderId: "711539772164",
  appId: "1:711539772164:web:e7736325e6ed365c0bde51"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const dbRef = ref(db, "participantes");

// Aplicar configura√ß√µes na interface
function aplicarConfiguracoes() {
  document.getElementById('tituloBolao').textContent = CONFIG.TITULO_BOLAO;
  document.getElementById('subtituloBolao').innerHTML = `${CONFIG.SUBTITULO}<br><br>
    ‚úçÔ∏è Preencha os dados corretamente!<br>
    <small>üìã Essas informa√ß√µes ser√£o usadas para entrega das cotas.</small>`;
  
  document.getElementById('limiteInfo').textContent = `${CONFIG.LIMITE_PARTICIPANTES} participantes`;
  document.getElementById('valorInfo').textContent = CONFIG.VALOR_PARTICIPACAO;
  document.getElementById('dataInteresseInfo').textContent = CONFIG.DATA_LIMITE_INTERESSE;
  document.getElementById('dataPagamentoInfo').textContent = CONFIG.DATA_LIMITE_PAGAMENTO;
  document.getElementById('dataPagamentoInfo2').textContent = CONFIG.DATA_LIMITE_PAGAMENTO;
  
  document.getElementById('progressText').textContent = `0/${CONFIG.LIMITE_PARTICIPANTES} participantes`;
}

// Atualizar progresso
function atualizarProgresso() {
    get(dbRef).then((snapshot) => {
        const participantes = snapshot.exists() ? Object.values(snapshot.val()) : [];
        const totalCadastrados = participantes.length;
        const totalPagos = participantes.filter(p => p.status === "Pago").length;
        const progresso = (totalCadastrados / CONFIG.LIMITE_PARTICIPANTES) * 100;
        
        // Atualizar barra principal
        document.getElementById('progressFill').style.width = progresso + '%';
        document.getElementById('progressText').textContent = `${totalCadastrados}/${CONFIG.LIMITE_PARTICIPANTES} participantes`;
        
        // Atualizar barra da lista (se existir) - mostra pagos/cadastrados
        const progressFillLista = document.getElementById('progressFillLista');
        const progressTextLista = document.getElementById('progressTextLista');
        if (progressFillLista && progressTextLista) {
            const progressoPagos = totalCadastrados > 0 ? (totalPagos / totalCadastrados) * 100 : 0;
            progressFillLista.style.width = progressoPagos + '%';
            progressTextLista.textContent = `${totalPagos}/${totalCadastrados}`;
        }
    });
}

// CADASTRAR
document.getElementById("cadastrar").addEventListener("click", async () => {
  const nome = document.getElementById("nome").value.trim();
  const telefone = document.getElementById("telefone").value.trim();
  const mensagem = document.getElementById("mensagem");

  if (!nome || !telefone) {
    mensagem.textContent = "‚ö†Ô∏è Preencha todos os campos!";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }

  // Validar nome completo (m√≠nimo 2 palavras)
  const palavrasNome = nome.split(' ').filter(palavra => palavra.length > 0);
  if (palavrasNome.length < 2) {
    mensagem.textContent = "‚ö†Ô∏è Digite o nome completo (nome e sobrenome)!";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }

  // Validar telefone (DDD + 9¬∫ d√≠gito)
  const telefoneNumeros = telefone.replace(/\D/g, '');
  
  // Verificar se tem pelo menos 11 d√≠gitos (DDD + 9 d√≠gitos do n√∫mero)
  if (telefoneNumeros.length < 11) {
    mensagem.textContent = "‚ö†Ô∏è Telefone deve conter DDD + n√∫mero completo!";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }
  
  // Verificar se o terceiro d√≠gito √© 9 (nono d√≠gito obrigat√≥rio)
  if (telefoneNumeros.length === 11 && telefoneNumeros[2] !== '9') {
    mensagem.textContent = "‚ö†Ô∏è N√∫mero deve conter o 9¬∫ d√≠gito! Ex: (99) 99999-9999";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }
  
  // Se tem 10 d√≠gitos, verificar se n√£o est√° faltando o 9
  if (telefoneNumeros.length === 10) {
    mensagem.textContent = "‚ö†Ô∏è N√∫mero deve conter o 9¬∫ d√≠gito! Ex: (99) 99999-9999";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }

  const snapshot = await get(dbRef);
  const participantes = snapshot.exists() ? Object.values(snapshot.val()) : [];

  if (participantes.length >= CONFIG.LIMITE_PARTICIPANTES) {
    mensagem.textContent = `‚ùå Limite de ${CONFIG.LIMITE_PARTICIPANTES} participantes atingido!`;
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }

  const duplicado = participantes.some(p =>
    p.nome.toLowerCase() === nome.toLowerCase() &&
    p.telefone.replace(/\D/g, '') === telefone.replace(/\D/g, '')
  );

  if (duplicado) {
    mensagem.textContent = "‚ö†Ô∏è Esse cadastro j√° est√° na lista!";
    mensagem.style.color = "#e17055";
    mensagem.style.background = "rgba(225, 112, 85, 0.1)";
    return;
  }

  const novoCadastro = {
    numero: participantes.length + 1,
    nome,
    telefone,
    status: "N√£o pago"
  };

  await push(dbRef, novoCadastro);
  mensagem.innerHTML = `‚úÖ Cadastro realizado com sucesso!<br>
    <button id="entrarGrupo" style="background: linear-gradient(135deg, #25d366, #128c7e); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; margin-top: 10px; font-size: 14px; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3); transition: all 0.3s ease;">üì± Entrar no Grupo WhatsApp</button>`;
  mensagem.style.color = "#00b894";
  mensagem.style.background = "rgba(0, 184, 148, 0.1)";
  document.getElementById("nome").value = "";
  document.getElementById("telefone").value = "";
  
  // Adicionar evento ao bot√£o do grupo
  document.getElementById("entrarGrupo").addEventListener("click", () => {
    window.open("https://chat.whatsapp.com/Fdl9PzkiEBq9TnJHtlu2Rm?mode=wwt", "_blank", "noopener,noreferrer");
  });
  
  // Atualizar progresso
  atualizarProgresso();
});

// Vari√°veis globais para filtros
let participantesOriginais = [];
let filtroAtivo = "todos";

// Vari√°veis para sele√ß√£o m√∫ltipla
let participantesSelecionados = [];

// VER LISTA
document.getElementById("verLista").addEventListener("click", async () => {
  document.getElementById("overlay").style.display = "flex";
  const listaDiv = document.getElementById("lista");
  const buscarInput = document.getElementById("buscar");

  listaDiv.innerHTML = "Carregando lista...";

  const snapshot = await get(dbRef);
  if (!snapshot.exists()) {
    listaDiv.textContent = "Nenhum participante cadastrado.";
    return;
  }

  participantesOriginais = Object.values(snapshot.val());
  participantesOriginais.sort((a, b) => a.numero - b.numero);
  
  // Resetar filtros e sele√ß√µes
  filtroAtivo = "todos";
  participantesSelecionados = [];
  atualizarBotoesFiltro();
  aplicarFiltros();
  atualizarContadorSelecao();
  
  // Atualizar progresso da lista
  atualizarProgresso();

  // Event listener para busca
  buscarInput.addEventListener("input", aplicarFiltros);
  
  // Event listeners para filtros
  document.getElementById("filtroTodos").addEventListener("click", () => {
    filtroAtivo = "todos";
    atualizarBotoesFiltro();
    aplicarFiltros();
  });
  
  document.getElementById("filtroPagos").addEventListener("click", () => {
    filtroAtivo = "pagos";
    atualizarBotoesFiltro();
    aplicarFiltros();
  });
  
  document.getElementById("filtroNaoPagos").addEventListener("click", () => {
    filtroAtivo = "naoPagos";
    atualizarBotoesFiltro();
    aplicarFiltros();
  });
  
  // Event listeners para sele√ß√£o m√∫ltipla - remover listeners antigos primeiro
  const alterarBtn = document.getElementById("alterarStatusSelecionados");
  const notificarBtn = document.getElementById("notificarSelecionados");
  const excluirBtn = document.getElementById("excluirSelecionados");
  
  // Clonar elementos para remover todos os event listeners
  const novoAlterarBtn = alterarBtn.cloneNode(true);
  const novoNotificarBtn = notificarBtn.cloneNode(true);
  const novoExcluirBtn = excluirBtn.cloneNode(true);
  
  alterarBtn.parentNode.replaceChild(novoAlterarBtn, alterarBtn);
  notificarBtn.parentNode.replaceChild(novoNotificarBtn, notificarBtn);
  excluirBtn.parentNode.replaceChild(novoExcluirBtn, excluirBtn);
  
  // Adicionar novos event listeners
  novoAlterarBtn.addEventListener("click", () => {
    if (participantesSelecionados.length > 0) {
      mostrarTecladoVirtual(verificarSenhaAcaoMultipla('status'));
    }
  });
  
  novoNotificarBtn.addEventListener("click", () => {
    if (participantesSelecionados.length > 0) {
      mostrarTecladoVirtual(verificarSenhaAcaoMultipla('notificar'));
    }
  });
  
  novoExcluirBtn.addEventListener("click", () => {
    if (participantesSelecionados.length > 0) {
      mostrarTecladoVirtual(verificarSenhaAcaoMultipla('excluir'));
    }
  });
});

// FECHAR MODAL
document.getElementById("fecharLista").addEventListener("click", () => {
  document.getElementById("overlay").style.display = "none";
});

// POPUP INFORMATIVO
document.getElementById("fecharInfo").addEventListener("click", () => {
  document.getElementById("infoOverlay").style.display = "none";
});

// VER REGRAS
document.getElementById("verRegras").addEventListener("click", () => {
  document.getElementById("infoOverlay").style.display = "flex";
});



// Fun√ß√£o para aplicar filtros
function aplicarFiltros() {
  const termo = document.getElementById("buscar").value.toLowerCase();
  let participantesFiltrados = [...participantesOriginais];
  
  // Aplicar filtro de status
  switch(filtroAtivo) {
    case "pagos":
      participantesFiltrados = participantesFiltrados.filter(p => p.status === "Pago");
      break;
    case "naoPagos":
      participantesFiltrados = participantesFiltrados.filter(p => p.status === "N√£o pago");
      break;
    // "todos" n√£o precisa de filtro adicional
  }
  
  // Aplicar filtro de busca
  if (termo) {
    participantesFiltrados = participantesFiltrados.filter(p => 
      p.nome.toLowerCase().includes(termo)
    );
  }
  
  renderLista(participantesFiltrados);
}

// Fun√ß√£o para atualizar bot√µes de filtro
function atualizarBotoesFiltro() {
  document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
  
  switch(filtroAtivo) {
    case "todos":
      document.getElementById("filtroTodos").classList.add('active');
      break;
    case "pagos":
      document.getElementById("filtroPagos").classList.add('active');
      break;
    case "naoPagos":
      document.getElementById("filtroNaoPagos").classList.add('active');
      break;
  }
}

function renderLista(participantes) {
  const listaDiv = document.getElementById("lista");
  listaDiv.innerHTML = "";
  
  if (participantes.length === 0) {
    listaDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: #ccc;">Nenhum participante encontrado</div>';
    return;
  }
  
  participantes.forEach(p => {
    const linha = document.createElement("div");
    const statusClass = p.status.toLowerCase() === "pago" ? "pago" : "nao-pago";
    
    // Criar checkbox para sele√ß√£o m√∫ltipla
    const checkboxContainer = document.createElement("div");
    checkboxContainer.className = "checkbox-container";
    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.value = p.numero;
    checkbox.addEventListener('change', (e) => {
      if (e.target.checked) {
        participantesSelecionados.push(p);
        linha.classList.add('selected');
      } else {
        participantesSelecionados = participantesSelecionados.filter(sel => sel.numero !== p.numero);
        linha.classList.remove('selected');
      }
      atualizarContadorSelecao();
    });
    checkboxContainer.appendChild(checkbox);
    
    // Conte√∫do da linha
    const conteudo = document.createElement("span");
    conteudo.innerHTML = `üé´ ${String(p.numero).padStart(2, "0")}¬∞ - ${p.nome.toUpperCase()}`;
    conteudo.style.flex = "1";
    conteudo.style.textAlign = "left";
    
    const status = document.createElement("span");
    status.className = `status ${statusClass}`;
    status.textContent = p.status;
    
    linha.appendChild(checkboxContainer);
    linha.appendChild(conteudo);
    linha.appendChild(status);
    
    // Evento de clique
    linha.addEventListener('click', (e) => {
      if (e.target.type !== 'checkbox') {
        // Se n√£o clicou no checkbox, verificar se h√° sele√ß√µes ativas
        if (participantesSelecionados.length > 0) {
          // Se h√° sele√ß√µes, marcar/desmarcar este item
          checkbox.checked = !checkbox.checked;
          checkbox.dispatchEvent(new Event('change'));
        } else {
          // Se n√£o h√° sele√ß√µes, abrir a√ß√µes individuais
          participanteSelecionado = p;
          mostrarTecladoVirtual(verificarSenhaComTeclado);
        }
      }
    });
    
    listaDiv.appendChild(linha);
  });
}

// Vari√°vel global para controle de participante selecionado
let participanteSelecionado = null;

// Fun√ß√£o para abrir menu de a√ß√µes
function abrirMenuAcoes(participante) {
  participanteSelecionado = participante;
  document.getElementById("participanteInfo").textContent = `${participante.numero}¬∞ - ${participante.nome.toUpperCase()}`;
  document.getElementById("acoesOverlay").style.display = "flex";
}

// Fechar modal de a√ß√µes
document.getElementById("fecharAcoes").addEventListener("click", () => {
  document.getElementById("acoesOverlay").style.display = "none";
  participanteSelecionado = null;
});

// Alterar status
document.getElementById("alterarStatus").addEventListener("click", async () => {
  if (!participanteSelecionado) return;
  
  try {
    // Buscar participante no Firebase
    const snapshot = await get(dbRef);
    if (!snapshot.exists()) return;
    
    const dados = snapshot.val();
    const participanteKey = Object.keys(dados).find(key => 
      dados[key].nome === participanteSelecionado.nome
    );
    
    if (participanteKey) {
      const novoStatus = participanteSelecionado.status === "Pago" ? "N√£o pago" : "Pago";
      await update(ref(db, `participantes/${participanteKey}`), { 
        status: novoStatus 
      });
      
      mostrarConfirmacao(`‚úÖ Status alterado: ${novoStatus}`, "success");
      await recarregarLista();
    }
    
  } catch (error) {
    console.error('Erro ao atualizar status:', error);
    mostrarConfirmacao("‚ùå Erro ao executar a√ß√£o. Tente novamente.", "error");
  }
  
  document.getElementById("acoesOverlay").style.display = "none";
});

// Notificar participante
document.getElementById("notificarParticipante").addEventListener("click", () => {
  if (!participanteSelecionado) return;
  
  // Verificar se o status √© "N√£o pago"
  if (participanteSelecionado.status !== "N√£o pago") {
    mostrarConfirmacao("‚ö†Ô∏è Notifica√ß√£o dispon√≠vel apenas para participantes com status 'N√£o pago'", "error");
    document.getElementById("acoesOverlay").style.display = "none";
    return;
  }
  
  // Enviar notifica√ß√£o WhatsApp
  enviarNotificacaoWhatsApp(participanteSelecionado);
  document.getElementById("acoesOverlay").style.display = "none";
});

// Excluir participante
document.getElementById("excluirParticipante").addEventListener("click", async () => {
  if (!participanteSelecionado) return;
  
  try {
    // Buscar participante no Firebase
    const snapshot = await get(dbRef);
    if (!snapshot.exists()) return;
    
    const dados = snapshot.val();
    const participanteKey = Object.keys(dados).find(key => 
      dados[key].nome === participanteSelecionado.nome
    );
    
    if (participanteKey) {
      const participanteRef = ref(db, `participantes/${participanteKey}`);
      await remove(participanteRef);
      
      mostrarConfirmacao(`‚úÖ Participante exclu√≠do com sucesso`, "delete");
      await recarregarLista();
    }
    
  } catch (error) {
    console.error('Erro ao excluir participante:', error);
    mostrarConfirmacao("‚ùå Erro ao executar a√ß√£o. Tente novamente.", "error");
  }
  
  document.getElementById("acoesOverlay").style.display = "none";
});

// Mostrar confirma√ß√£o
function mostrarConfirmacao(mensagem, tipo) {
  const confirmacao = document.createElement('div');
  confirmacao.textContent = mensagem;
  
  let cor = "rgba(0, 184, 148, 0.9)"; // success
  if (tipo === "delete") cor = "rgba(231, 76, 60, 0.9)";
  if (tipo === "error") cor = "rgba(225, 112, 85, 0.9)";
  
  confirmacao.style.cssText = `position: fixed; top: 20px; right: 20px; background: ${cor}; color: white; padding: 12px 20px; border-radius: 10px; z-index: 9999; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.2);`;
  document.body.appendChild(confirmacao);
  setTimeout(() => confirmacao.remove(), 3000);
}

// Recarregar lista
async function recarregarLista() {
  const novoSnapshot = await get(dbRef);
  if (novoSnapshot.exists()) {
    participantesOriginais = Object.values(novoSnapshot.val());
    participantesOriginais.sort((a, b) => a.numero - b.numero);
    
    // Reordenar n√∫meros sequencialmente
    await reordenarNumeros(participantesOriginais);
    
    // Aplicar filtros atuais
    aplicarFiltros();
  } else {
    document.getElementById("lista").innerHTML = "Nenhum participante cadastrado.";
  }
  atualizarProgresso();
}

// Fun√ß√£o para reordenar n√∫meros sequencialmente
async function reordenarNumeros(participantes) {
  const snapshot = await get(dbRef);
  if (!snapshot.exists()) return;
  
  const dados = snapshot.val();
  const updates = {};
  
  // Reordenar participantes por n√∫mero atual
  participantes.sort((a, b) => a.numero - b.numero);
  
  // Atualizar n√∫meros sequencialmente
  participantes.forEach((participante, index) => {
    const novoNumero = index + 1;
    if (participante.numero !== novoNumero) {
      // Encontrar a chave do participante no Firebase
      const participanteKey = Object.keys(dados).find(key => 
        dados[key].nome === participante.nome && dados[key].telefone === participante.telefone
      );
      
      if (participanteKey) {
        updates[`participantes/${participanteKey}/numero`] = novoNumero;
        participante.numero = novoNumero; // Atualizar localmente tamb√©m
      }
    }
  });
  
  // Aplicar todas as atualiza√ß√µes de uma vez
  if (Object.keys(updates).length > 0) {
    await update(ref(db), updates);
  }
}

// === TECLADO VIRTUAL ===
let senhaAtual = "";
let callbackConfirmacao = null;

// Mostrar teclado virtual
function mostrarTecladoVirtual(callback) {
  senhaAtual = "";
  callbackConfirmacao = callback;
  document.getElementById("passwordDisplay").textContent = "";
  document.getElementById("virtualKeyboard").style.display = "block";
  
  // Esconder modal de senha se estiver aberto
  document.getElementById("senhaOverlay").style.display = "none";
}

// Esconder teclado virtual
function esconderTecladoVirtual() {
  document.getElementById("virtualKeyboard").style.display = "none";
  senhaAtual = "";
  callbackConfirmacao = null;
}

// Eventos do teclado virtual
document.addEventListener('DOMContentLoaded', () => {
  const keyboard = document.getElementById("virtualKeyboard");
  const passwordDisplay = document.getElementById("passwordDisplay");
  
  keyboard.addEventListener('click', (e) => {
    if (!e.target.classList.contains('key-btn')) return;
    
    const key = e.target.getAttribute('data-key');
    
    switch(key) {
      case 'cancel':
        esconderTecladoVirtual();
        // Limpar vari√°veis de a√ß√£o se cancelar
        participanteSelecionado = null;
        break;
        
      default:
        // Aceitar apenas n√∫meros (0-9) e s√≠mbolos * #
        if (/^[0-9*#]$/.test(key) && senhaAtual.length < 4) {
          senhaAtual += key;
          passwordDisplay.textContent = "‚óè".repeat(senhaAtual.length);
          
          // Verificar automaticamente quando atingir 4 d√≠gitos
          if (senhaAtual.length === 4) {
            setTimeout(() => {
              if (callbackConfirmacao) {
                callbackConfirmacao(senhaAtual);
              }
              esconderTecladoVirtual();
            }, 300); // Pequeno delay para mostrar o √∫ltimo ponto
          }
        }
        break;
    }
  });
  
  // Aplicar configura√ß√µes quando a p√°gina carregar
  aplicarConfiguracoes();
});

// Fun√ß√£o para enviar notifica√ß√£o WhatsApp
function enviarNotificacaoWhatsApp(participante) {
  // Limpar o n√∫mero de telefone (remover caracteres especiais)
  const telefone = participante.telefone.replace(/\D/g, '');
  
  // Verificar se o n√∫mero tem DDD (pelo menos 10 d√≠gitos)
  if (telefone.length < 10) {
    mostrarConfirmacao("‚ùå N√∫mero de telefone inv√°lido", "error");
    return;
  }
  
  // Adicionar c√≥digo do pa√≠s se necess√°rio
  const numeroCompleto = telefone.startsWith('55') ? telefone : '55' + telefone;
  
  // Usar a mensagem configurada
  const mensagem = CONFIG.MENSAGEM_NOTIFICACAO(
    participante.nome,
    CONFIG.VALOR_PARTICIPACAO,
    CONFIG.DATA_LIMITE_PAGAMENTO,
    CONFIG.CHAVE_PIX
  );
  
  // Codificar a mensagem para URL
  const mensagemCodificada = encodeURIComponent(mensagem);
  
  // Criar URL do WhatsApp
  const urlWhatsApp = `https://wa.me/${numeroCompleto}?text=${mensagemCodificada}`;
  
  // Abrir WhatsApp em nova aba
  window.open(urlWhatsApp, '_blank', 'noopener,noreferrer');
  
  // Mostrar confirma√ß√£o
  mostrarConfirmacao(`üì± WhatsApp aberto para ${participante.nome}`, "success");
}

// Verificar senha e abrir menu de a√ß√µes
function verificarSenhaComTeclado(senhaDigitada) {
  if (senhaDigitada === CONFIG.SENHA_ADMIN) {
    // Senha correta - abrir menu de a√ß√µes
    document.getElementById("participanteInfo").textContent = `${participanteSelecionado.numero}¬∞ - ${participanteSelecionado.nome.toUpperCase()}`;
    document.getElementById("acoesOverlay").style.display = "flex";
  } else {
    // Senha incorreta - mostrar erro
    const confirmacao = document.createElement('div');
    confirmacao.textContent = "‚ùå Senha incorreta!";
    confirmacao.style.cssText = "position: fixed; top: 20px; right: 20px; background: rgba(231, 76, 60, 0.9); color: white; padding: 12px 20px; border-radius: 10px; z-index: 9999; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.2);";
    document.body.appendChild(confirmacao);
    setTimeout(() => confirmacao.remove(), 3000);
  }
}

// Verificar senha para a√ß√µes m√∫ltiplas
function verificarSenhaAcaoMultipla(acao) {
  return function(senhaDigitada) {
    if (senhaDigitada === CONFIG.SENHA_ADMIN) {
      if (acao === 'status') {
        alterarStatusSelecionados();
      } else if (acao === 'excluir') {
        excluirSelecionados();
      } else if (acao === 'notificar') {
        notificarSelecionados();
      }
    } else {
      const confirmacao = document.createElement('div');
      confirmacao.textContent = "‚ùå Senha incorreta!";
      confirmacao.style.cssText = "position: fixed; top: 20px; right: 20px; background: rgba(231, 76, 60, 0.9); color: white; padding: 12px 20px; border-radius: 10px; z-index: 9999; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.2);";
      document.body.appendChild(confirmacao);
      setTimeout(() => confirmacao.remove(), 3000);
    }
  };
}

// Limpar sele√ß√µes
function limparSelecoes() {
  participantesSelecionados = [];
  
  // Limpar checkboxes e classes selected
  document.querySelectorAll('.checkbox-container input[type="checkbox"]').forEach(checkbox => {
    checkbox.checked = false;
  });
  
  document.querySelectorAll('.lista div.selected').forEach(linha => {
    linha.classList.remove('selected');
  });
  
  atualizarContadorSelecao();
}

// Atualizar contador de sele√ß√£o
function atualizarContadorSelecao() {
  const counter = document.getElementById("selectionCounter");
  const actions = document.getElementById("selectionActions");
  const count = participantesSelecionados.length;
  
  if (count === 0) {
    counter.textContent = "Nenhum participante selecionado";
    counter.style.display = "none";
    actions.style.display = "none";
  } else {
    counter.style.display = "block";
    actions.style.display = "flex";
    if (count === 1) {
      counter.textContent = "1 participante selecionado";
    } else {
      counter.textContent = `${count} participantes selecionados`;
    }
  }
}

// Alterar status dos selecionados
async function alterarStatusSelecionados() {
  if (participantesSelecionados.length === 0) return;
  
  try {
    const snapshot = await get(dbRef);
    if (!snapshot.exists()) return;
    
    const dados = snapshot.val();
    const updates = {};
    
    // Determinar novo status (se todos s√£o "Pago", muda para "N√£o pago", sen√£o muda para "Pago")
    const todosPagos = participantesSelecionados.every(p => p.status === "Pago");
    const novoStatus = todosPagos ? "N√£o pago" : "Pago";
    
    participantesSelecionados.forEach(participante => {
      const participanteKey = Object.keys(dados).find(key => 
        dados[key].nome === participante.nome && dados[key].telefone === participante.telefone
      );
      
      if (participanteKey) {
        updates[`participantes/${participanteKey}/status`] = novoStatus;
      }
    });
    
    if (Object.keys(updates).length > 0) {
      await update(ref(db), updates);
      mostrarConfirmacao(`‚úÖ Status alterado para "${novoStatus}" em ${participantesSelecionados.length} participante(s)`, "success");
      await recarregarLista();
      limparSelecoes();
    }
    
  } catch (error) {
    console.error('Erro ao atualizar status:', error);
    mostrarConfirmacao("‚ùå Erro ao executar a√ß√£o. Tente novamente.", "error");
  }
}

// Notificar selecionados
function notificarSelecionados() {
  if (participantesSelecionados.length === 0) return;
  
  // Filtrar apenas participantes com status "N√£o pago"
  const participantesNaoPagos = participantesSelecionados.filter(p => p.status === "N√£o pago");
  
  if (participantesNaoPagos.length === 0) {
    mostrarConfirmacao("‚ö†Ô∏è Nenhum participante selecionado tem status 'N√£o pago'", "error");
    return;
  }
  
  let contador = 0;
  const total = participantesNaoPagos.length;
  
  // Enviar notifica√ß√µes com intervalo para evitar spam
  participantesNaoPagos.forEach((participante, index) => {
    setTimeout(() => {
      enviarNotificacaoWhatsApp(participante);
      contador++;
      
      // Mostrar progresso
      if (contador === 1) {
        mostrarConfirmacao(`üì± Enviando notifica√ß√µes... (${contador}/${total})`, "success");
      } else if (contador === total) {
        mostrarConfirmacao(`‚úÖ ${total} notifica√ß√£o(√µes) enviada(s) com sucesso!`, "success");
        limparSelecoes();
      }
    }, index * 1000); // Intervalo de 1 segundo entre cada notifica√ß√£o
  });
}

// Excluir selecionados
async function excluirSelecionados() {
  if (participantesSelecionados.length === 0) return;
  
  try {
    const snapshot = await get(dbRef);
    if (!snapshot.exists()) return;
    
    const dados = snapshot.val();
    const promises = [];
    
    participantesSelecionados.forEach(participante => {
      const participanteKey = Object.keys(dados).find(key => 
        dados[key].nome === participante.nome && dados[key].telefone === participante.telefone
      );
      
      if (participanteKey) {
        const participanteRef = ref(db, `participantes/${participanteKey}`);
        promises.push(remove(participanteRef));
      }
    });
    
    if (promises.length > 0) {
      await Promise.all(promises);
      mostrarConfirmacao(`‚úÖ ${participantesSelecionados.length} participante(s) exclu√≠do(s) com sucesso`, "delete");
      await recarregarLista();
      limparSelecoes();
    }
    
  } catch (error) {
    console.error('Erro ao excluir participantes:', error);
    mostrarConfirmacao("‚ùå Erro ao executar a√ß√£o. Tente novamente.", "error");
  }
}

// Inicializar progresso
atualizarProgresso();
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'993bfa52f1c37263',t:'MTc2MTMzNTE2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
